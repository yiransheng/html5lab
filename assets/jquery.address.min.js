(function(a){a.address=(function(){var d=function(aj){a(a.address).trigger(a.extend(a.Event(aj),(function(){var an={},am=a.address.parameterNames();for(var al=0,ak=am.length;al<ak;al++){an[am[al]]=a.address.parameter(am[al])}return{value:a.address.value(),path:a.address.path(),pathNames:a.address.pathNames(),parameterNames:am,parameters:an,queryString:a.address.queryString()}}).call(a.address)))},k=function(aj){return Array.prototype.slice.call(aj)},j=function(al,ak,aj){a().bind.apply(a(a.address),Array.prototype.slice.call(arguments));return a.address},O=function(){return(ac.pushState&&F.state!==K)},J=function(){return("/"+Y.pathname.replace(new RegExp(F.state),"")+Y.search+(U()?"#"+U():"")).replace(Q,"/")},U=function(){var aj=Y.href.indexOf("#");return aj!=-1?E(Y.href.substr(aj+1),ad):""},A=function(){return O()?J():U()},b=function(){try{return top.document!==K?top:window}catch(aj){return window}},l=function(){return"javascript"},ah=function(aj){aj=aj.toString();return(F.strict&&aj.substr(0,1)!="/"?"/":"")+aj},E=function(aj,ak){if(F.crawlable&&ak){return(aj!==""?"!":"")+aj}return aj.replace(/^\!/,"")},T=function(aj,ak){return parseInt(aj.css(ak),10)},ab=function(){if(!t){var ak=A(),aj=W!=ak;if(aj){if(h&&q<7){Y.reload()}else{if(h&&!P&&F.history){n(G,50)}W=ak;Z(ad)}}}},Z=function(aj){d(I);d(aj?g:ag);n(x,10)},x=function(){if(F.tracker!=="null"&&F.tracker!==null){var aj=a.isFunction(F.tracker)?F.tracker:R[F.tracker],ak=(Y.pathname+Y.search+(a.address&&!O()?a.address.value():"")).replace(/\/\//,"/").replace(/^\/$/,"");if(a.isFunction(aj)){aj(ak)}else{if(a.isFunction(R.urchinTracker)){R.urchinTracker(ak)}else{if(R.pageTracker!==K&&a.isFunction(R.pageTracker._trackPageview)){R.pageTracker._trackPageview(ak)}else{if(R._gaq!==K&&a.isFunction(R._gaq.push)){R._gaq.push(["_trackPageview",decodeURI(ak)])}}}}}},G=function(){var aj=l()+":"+ad+";document.open();document.writeln('<html><head><title>"+af.title.replace(/\'/g,"\\'")+"</title><script>var "+z+' = "'+A()+(af.domain!=Y.hostname?'";document.domain="'+af.domain:"")+"\";<\/script></head></html>');document.close();";if(q<7){e.src=aj}else{e.contentWindow.location.replace(aj)}},ae=function(){if(i&&c!=-1){var aj,al,ak=i.substr(c+1).split("&");for(aj=0;aj<ak.length;aj++){al=ak[aj].split("=");if(/^(autoUpdate|crawlable|history|strict|wrap)$/.test(al[0])){F[al[0]]=(isNaN(al[1])?/^(true|yes)$/i.test(al[1]):(parseInt(al[1],10)!==0))}if(/^(state|tracker)$/.test(al[0])){F[al[0]]=al[1]}}i=null}W=A()},S=function(){if(!X){X=D;ae();var al=function(){w.call(this);r.call(this)},ak=a("body").ajaxComplete(al);al();if(F.wrap){var am=a("body > *").wrapAll('<div style="padding:'+(T(ak,"marginTop")+T(ak,"paddingTop"))+"px "+(T(ak,"marginRight")+T(ak,"paddingRight"))+"px "+(T(ak,"marginBottom")+T(ak,"paddingBottom"))+"px "+(T(ak,"marginLeft")+T(ak,"paddingLeft"))+'px;" />').parent().wrap('<div id="'+z+'" style="height:100%;overflow:auto;position:relative;'+(s&&!window.statusbar.visible?"resize:both;":"")+'" />');a("html, body").css({height:"100%",margin:0,padding:0,overflow:"hidden"});if(s){a('<style type="text/css" />').appendTo("head").text("#"+z+"::-webkit-resizer { background-color: #fff; }")}}if(h&&!P){var aj=af.getElementsByTagName("frameset")[0];e=af.createElement((aj?"":"i")+"frame");e.src=l()+":"+ad;if(aj){aj.insertAdjacentElement("beforeEnd",e);aj[aj.cols?"cols":"rows"]+=",0";e.noResize=D;e.frameBorder=e.frameSpacing=0}else{e.style.display="none";e.style.width=e.style.height=0;e.tabIndex=-1;af.body.insertAdjacentElement("afterBegin",e)}n(function(){a(e).bind("load",function(){var an=e.contentWindow;W=an[z]!==K?an[z]:"";if(W!=A()){Z(ad);Y.hash=E(W,D)}});if(e.contentWindow[z]===K){G()}},50)}n(function(){d("init");Z(ad)},1);if(!O()){if(P){if(R.addEventListener){R.addEventListener(V,ab,ad)}else{if(R.attachEvent){R.attachEvent("on"+V,ab)}}}else{u(ab,50)}}if("state" in window.history){a(window).trigger("popstate")}}},w=function(){var am,ap=a("a"),an=ap.size(),ak=1,aj=-1,ao='[rel*="address:"]',al=function(){if(++aj!=an){am=a(ap.get(aj));if(am.is(ao)){am.address(ao)}n(al,ak)}};n(al,ak)},p=function(){if(W!=A()){W=A();Z(ad)}},o=function(){if(R.removeEventListener){R.removeEventListener(V,ab,ad)}else{if(R.detachEvent){R.detachEvent("on"+V,ab)}}},r=function(){if(F.crawlable){var ak=Y.pathname.replace(/\/$/,""),aj="_escaped_fragment_";if(a("body").html().indexOf(aj)!=-1){a('a[href]:not([href^=http]), a[href*="'+document.domain+'"]').each(function(){var al=a(this).attr("href").replace(/^http:/,"").replace(new RegExp(ak+"/?$"),"");if(al===""||al.indexOf(aj)!=-1){a(this).attr("href","#"+encodeURI(decodeURIComponent(al.replace(new RegExp("/(.*)\\?"+aj+"=(.*)$"),"!$2"))))}})}}},K,H=null,z="jQueryAddress",aa="string",V="hashchange",m="init",I="change",g="internalChange",ag="externalChange",D=true,ad=false,F={autoUpdate:D,crawlable:ad,history:D,strict:D,wrap:ad},C=a.browser,q=parseFloat(C.version),h=!a.support.opacity,s=C.webkit||C.safari,R=b(),af=R.document,ac=R.history,Y=R.location,u=setInterval,n=setTimeout,Q=/\/{2,9}/g,ai=navigator.userAgent,P="on"+V in R,e,M,i=a("script:last").attr("src"),c=i?i.indexOf("?"):-1,L=af.title,t=ad,X=ad,N=D,y=ad,B={},W=A();if(h){q=parseFloat(ai.substr(ai.indexOf("MSIE")+4));if(af.documentMode&&af.documentMode!=q){q=af.documentMode!=8?7:8}var v=af.onpropertychange;af.onpropertychange=function(){if(v){v.call(af)}if(af.title!=L&&af.title.indexOf("#"+A())!=-1){af.title=L}}}if(ac.navigationMode){ac.navigationMode="compatible"}if(document.readyState=="complete"){var f=setInterval(function(){if(a.address){S();clearInterval(f)}},50)}else{ae();a(S)}a(window).bind("popstate",p).bind("unload",o);return{bind:function(ak,al,aj){return j.apply(this,k(arguments))},init:function(ak,aj){return j.apply(this,[m].concat(k(arguments)))},change:function(ak,aj){return j.apply(this,[I].concat(k(arguments)))},internalChange:function(ak,aj){return j.apply(this,[g].concat(k(arguments)))},externalChange:function(ak,aj){return j.apply(this,[ag].concat(k(arguments)))},baseURL:function(){var aj=Y.href;if(aj.indexOf("#")!=-1){aj=aj.substr(0,aj.indexOf("#"))}if(/\/$/.test(aj)){aj=aj.substr(0,aj.length-1)}return aj},autoUpdate:function(aj){if(aj!==K){F.autoUpdate=aj;return this}return F.autoUpdate},crawlable:function(aj){if(aj!==K){F.crawlable=aj;return this}return F.crawlable},history:function(aj){if(aj!==K){F.history=aj;return this}return F.history},state:function(aj){if(aj!==K){F.state=aj;var ak=J();if(F.state!==K){if(ac.pushState){if(ak.substr(0,3)=="/#/"){Y.replace(F.state.replace(/^\/$/,"")+ak.substr(2))}}else{if(ak!="/"&&ak.replace(/^\/#/,"")!=U()){n(function(){Y.replace(F.state.replace(/^\/$/,"")+"/#"+ak)},1)}}}return this}return F.state},strict:function(aj){if(aj!==K){F.strict=aj;return this}return F.strict},tracker:function(aj){if(aj!==K){F.tracker=aj;return this}return F.tracker},wrap:function(aj){if(aj!==K){F.wrap=aj;return this}return F.wrap},update:function(){y=D;this.value(W);y=ad;return this},title:function(aj){if(aj!==K){n(function(){L=af.title=aj;if(N&&e&&e.contentWindow&&e.contentWindow.document){e.contentWindow.document.title=aj;N=ad}},50);return this}return af.title},value:function(aj){if(aj!==K){aj=ah(aj);if(aj=="/"){aj=""}if(W==aj&&!y){return}W=aj;if(F.autoUpdate||y){Z(D);if(O()){ac[F.history?"pushState":"replaceState"]({},"",F.state.replace(/\/$/,"")+(W===""?"/":W))}else{t=D;if(s){if(F.history){Y.hash="#"+E(W,D)}else{Y.replace("#"+E(W,D))}}else{if(W!=A()){if(F.history){Y.hash="#"+E(W,D)}else{Y.replace("#"+E(W,D))}}}if((h&&!P)&&F.history){n(G,50)}if(s){n(function(){t=ad},1)}else{t=ad}}}return this}return ah(W)},path:function(ak){if(ak!==K){var aj=this.queryString(),al=this.hash();this.value(ak+(aj?"?"+aj:"")+(al?"#"+al:""));return this}return ah(W).split("#")[0].split("?")[0]},pathNames:function(){var ak=this.path(),aj=ak.replace(Q,"/").split("/");if(ak.substr(0,1)=="/"||ak.length===0){aj.splice(0,1)}if(ak.substr(ak.length-1,1)=="/"){aj.splice(aj.length-1,1)}return aj},queryString:function(ak){if(ak!==K){var al=this.hash();this.value(this.path()+(ak?"?"+ak:"")+(al?"#"+al:""));return this}var aj=W.split("?");return aj.slice(1,aj.length).join("?").split("#")[0]},parameter:function(ak,at,am){var aq,ao;if(at!==K){var ar=this.parameterNames();ao=[];at=at===K||at===null?"":at.toString();for(aq=0;aq<ar.length;aq++){var an=ar[aq],au=this.parameter(an);if(typeof au==aa){au=[au]}if(an==ak){au=(at===null||at==="")?[]:(am?au.concat([at]):[at])}for(var ap=0;ap<au.length;ap++){ao.push(an+"="+au[ap])}}if(a.inArray(ak,ar)==-1&&at!==null&&at!==""){ao.push(ak+"="+at)}this.queryString(ao.join("&"));return this}at=this.queryString();if(at){var aj=[];ao=at.split("&");for(aq=0;aq<ao.length;aq++){var al=ao[aq].split("=");if(al[0]==ak){aj.push(al.slice(1).join("="))}}if(aj.length!==0){return aj.length!=1?aj:aj[0]}}},parameterNames:function(){var aj=this.queryString(),am=[];if(aj&&aj.indexOf("=")!=-1){var an=aj.split("&");for(var al=0;al<an.length;al++){var ak=an[al].split("=")[0];if(a.inArray(ak,am)==-1){am.push(ak)}}}return am},hash:function(ak){if(ak!==K){this.value(W.split("#")[0]+(ak?"#"+ak:""));return this}var aj=W.split("#");return aj.slice(1,aj.length).join("#")}}})();a.fn.address=function(b){var d;if(typeof b=="string"){d=b;b=undefined}if(!a(this).attr("address")){var c=function(g){if(g.shiftKey||g.ctrlKey||g.metaKey||g.which==2){return true}if(a(this).is("a")){g.preventDefault();var f=b?b.call(this):/address:/.test(a(this).attr("rel"))?a(this).attr("rel").split("address:")[1].split(" ")[0]:a.address.state()!==undefined&&!/^\/?$/.test(a.address.state())?a(this).attr("href").replace(new RegExp("^(.*"+a.address.state()+"|\\.)"),""):a(this).attr("href").replace(/^(#\!?|\.)/,"");a.address.value(f)}};a(d?d:this).live("click",c).live("submit",function(h){if(a(this).is("form")){h.preventDefault();var g=a(this).attr("action"),f=b?b.call(this):(g.indexOf("?")!=-1?g.replace(/&$/,""):g+"?")+a(this).serialize();a.address.value(f)}}).attr("address",true)}return this}})(jQuery);